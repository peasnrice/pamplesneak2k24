{% extends "default_base.html" %}
{% load static %}

{% block head %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script>
    var gameId = "{{ game.id }}";
    var playerId = "{{ player.id }}";
  </script>
{% endblock %}

{% block jumbotron %}
  <!-- Flex container with responsive direction -->
    <div class="flex flex-col md:flex-row justify-between items-center p-4">
        
        <!-- Left side: Game Info and Buttons, stacks on top on small screens -->
        <div class="min-h-[150px]">
            <h1 class="text-3xl font-bold">{{ game.game_name }} Lobby!</h1>
            <h2 class="text-2xl">Game Room Code: {{ game.game_room_code }}</h2>
            
            <form method="post" action="">
                {% csrf_token %}
                {% if user_is_host %}
                    <div class="flex flex-col sm:flex-row my-4 space-y-2 sm:space-y-0 sm:space-x-2">
                        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded flex-grow">
                            Start Game (You are the host, only You can do this)
                        </button>
                    </div>
                {% endif %}
            </form>
        </div>

        <!-- Right side: QR Code, moves below on small screens -->
        <div class="mt-4 md:mt-0 md:ml-4">
            <img src="{% url 'gameroom:qr_code' game_id=game.id slug=game.slug %}" alt="QR Code" id="qrCodeImage" style="height: 150px;" class="">
        </div>
    </div>
</div>
{% endblock %}

{% block content %}

<!-- Display Players -->
<div class="mt-4">
    <h3 class="text-2xl font-bold">Players in Lobby:</h3>
    <ul class="list-disc ml-5 player-list">
        {% for player in players %}
            <li>
                {{ player.name }} 
                {% if player.user == game.host %}
                    (host)
                {% endif %}
            </li>
        {% empty %}
            <li>No players yet.</li>
        {% endfor %}
    </ul>
</div>

{% block scripts %}
<script src="{% static 'js/lobby_socket.js' %}"></script>
{% endblock %}

{% endblock %}